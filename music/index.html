<!DOCTYPE HTML>
<html lang="en">

<head>
  <title>Garrett Cox</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="google-site-verification" content="QKaBf-q9jtSoWsWHrzudNrFiJ70f3xbvvpbASCjtNdQ" />
  <meta name="author" content="Garrett Cox">
  <meta name="description" content="Garrett Cox's Personal Website" />
  <meta name="keywords" content="Garrett Joe Cox personal website github angellist linkedin populr game-of-life" />
  <meta property="og:title" content="Garrett Cox" />
  <meta property="og:description" content="Garrett Cox's Personal Website" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="http://garrettcox.io/" />
  <meta property="og:image" content="http://garrettcox.io/assets/og2.png" />
  <link rel="stylesheet" type="text/css" href="/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.11/lodash.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
</head>

<body class="">
  <div id="particles"></div>
  <div class="row contained aic">
    <div class="header">music i love</div>
    <div class="now-playing-hide col">
      <div>currently listening to</div>
      <div class="now-playing-song"></div>
    </div>
  </div>
  <div class="f1 row aic jcc albums"></div>
  <script>
    (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date(); a = s.createElement(o),
      m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-88756080-1', 'auto');
    ga('send', 'pageview');

    particlesJS.load('particles', '/particles.json');

    const headers = {
      Accept: 'application/json',
      'Content-Type': 'application/json',
      Authorization: 'Bearer BQAViI2bycJh9ZccZzU8vxKwGxReYJnOYF-8YMAIAEeC2Uf4_DM2fZYKWOlPFWb90CNEV8QqdatuTDQkMQ_RoHEcqGrmdD3LLbIHEeDRPeCBlOkZ-0mIqIox1ZSXvOtotVB_tejs1k8mQUrkZI67dSsBUEqzVe7Ku8AJKjQJxcQ',
    };
    (async () => {
      const nowPlayingHide = document.querySelector('.now-playing-hide');
      const nowPlayingEl = document.querySelector('.now-playing-song');
      const response = await fetch('https://api.spotify.com/v1/me/player/currently-playing', { headers });
      const body = await response.json();
      if (body && body.item) {
        nowPlayingHide.style.display = 'block';
        nowPlayingEl.innerHTML = `${body.item.name} - ${body.item.artists[0].name}`;
      }
    })();

    (async () => {
      const albumsEl = document.querySelector('.albums');
      const frag = document.createDocumentFragment();

      const items = [
        '40ucxnGO51wcTGNI6xge6z',
        '40QTqOBBxCEIQlLNdSjFQB',
        '2nkto6YNI4rUYTLqEwWJ3o',
        '3mH6qwIy9crq0I9YQbOuDf',
        '392p3shh2jkxUxY2VHvlH8',
        '4NZWRpoMuXaHU7csTjWdB5',
        '4xkM0BwLM9H2IUcbYzpcBI',
        '2RIzTjf0GcKm1I2FQV19zw',
        '64uUQtKfndQguejYmA40lL',
        '4GNIhgEGXzWGAefgN5qjdU',
        '32KdoFFhgjCLdU0DWL71tx',
        '6TWqxofcKQaZ9gHI49G36P',
        '01uabHpYa9AA55wc6AwRQL',
        '2cRMVS71c49Pf5SnIlJX3U',
        '2rmMeEq5D1Bg7YFRwtHBDr',
        '34GQP3dILpyCN018y2k61L',
        '79dL7FLiJFOO0EoehUHQBv',
        '0P3oVJBFOv3TDXlYRhGL7s',
        '5EbpxRwbbpCJUepbqVTZ1U',
        '2Qi2SySN2ePZwMLDSv9Krn',
        '23dMwCv6redn6pcyliSlGk',
        '7JcfNKXoHSaog85a1hd4lx',
        '3WrufJir7I61NkvkDwxero',
        '4uP43hIpmEEDuW7aOfiU2C',
        '6ZG5lRT77aJ3btmArcykra',
        '0RHX9XECH8IVI3LNgWDpmQ',
        '4E7bV0pzG0LciBSWTszra6',
        '1yyCXBEu27Ia1Y3torWIwC',
        '3Gt7rOjcZQoHCfnKl5AkK7',
        '7CYDRyFCKtAYJBSpfovLyX',
        '7awgq3vvlsIeA7dZduR9x4',
        '5CZR6ljD0x9fTiS4mh9wMp',
        '1ORxRsK3MrSLvh7VQTF01F',
        '6C6RtR4rwoonc10cv4sSDF',
        '47MVgO7XNmxzoYSJIvqxAG',
        '0IQbQC6V4UuHLcgO9Yt3uu',
        '6mm1Skz3JE6AXneya9Nyiv',
        '3EqIz9KGQakhATc71OGQQi',
        '48mPoqbdK2eJcEyTjZmBPU',
        '0rmhjUgoVa17LZuS8xWQ3v',
      ];

      const albumData = await Promise.all(_.chunk(_.shuffle(items), 20).map(async (chunk) => {
        const response = await fetch(`https://api.spotify.com/v1/albums?market=ES&ids=${chunk.join(',')}`, { headers });

        const body = await response.json();

        return body.albums;
      }));

      _.flatten(albumData).forEach(album => {
        const el = document.createElement('a');
        el.classList.add('album');
        el.setAttribute('href', album.external_urls.spotify);
        el.style.backgroundImage = `url(${album.images[1].url})`;
        frag.appendChild(el);
      });

      albumsEl.appendChild(frag);
    })();

</script>
</body>

</html>
